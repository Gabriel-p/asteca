
\documentclass[10pt]{article}

\begin{document}


\begin{center}
\begin{Huge}
OCAAT\\
\end{Huge}
{\huge (Open Cluster Automated Analysis Tool)\\}
\vspace{1cm}
\begin{Large}
\textbf{Manual v1.0.0 (\today)}
\end{Large}
\end{center}

\clearpage

\section{Introduction}
This is the manual of operation for the \texttt{OCAAT} code.

\section{Synthetic clusters}

\subsection{IMF sampling}

The initial mass function (IMF) is the distribution of initial masses for a population
of stars. For a population of $N$ stars with masses $m_i$ and a total mass of $M_T$:\\

$IMF \, \rightarrow \, \xi(m)=\frac{dn}{dm} \, \rightarrow \,dn = \xi(m)dm$\\

$M_T= \sum_{i=1}^N m_i \, \rightarrow \, M_T = C\int_{m_l}^{m_h} m(n)dn = $\\

$= C\int_{m_l}^{m_h} m\xi(m)dm$\\

\noindent where $m_l$ and $m_h$ are the mass limits for the IMF ($m_h$ is fixed to
$100 M_{\odot}$ in the code) and $C$ is a normalization constant. Setting the total
mass to unity, $M_T=1 M_{\odot}$, allows us to obtain the normalization constant $C_1$
and treat the normalized IMF as a PDF:\\

$M_T=1M_{\odot}\, \rightarrow \, C_1 = \frac{1}{\int_{m_l}^{m_h} m\xi(m)dm}$\\

\noindent and thus the normalized IMF can be written as:\\

$PDF(m) = \xi(m)_{norm} = C_1 \xi(m) $\\

This is the first step, performed by the \texttt{get-IMF-PDF} function for a given selected
IMF (Chabrier 2001, Kro"upa et al. 1993, Kroupa 2002)\\


Once the PDF is generated, every time a new synthetic cluster is created the
\texttt{get-mass-dist} function is called from within \texttt{synth-cluster}. This
former function takes the PDF and samples a number of masses randomly from it, following
the probabilities distribution given by the PDF, until the mass fixed by the
\texttt{total-mass} parameter is achieved.

The \texttt{get-mass-dist} function thus returns a distribution of masses probabilistically
sampled from a certain IMF, whose masses sum up to a total cluster mass.


\section{Adding CMD support}

In order to add support for a new CMD the following functions should be modified:
\begin{enumerate}
\item \texttt{get-in-params}, add names of filters and positions needed to form the color
\item \texttt{get-isoch-params}, add the columns in the theoretical isochrone
where the code should look for the filters used.
\item \texttt{move-isochrone}, add the extinction equations that define how
this effect along with the distance modulus affect the magnitude and color
in the CMD.
\end{enumerate}

\section{Integrated magnitudes}

To obtain the integrated magnitude for the cluster region \textit{cleaned}
from field stars contamination, the following equations are used.

First, assume:

\begin{equation}
I_{cl+fl} = I_{cl} + I_{fl}
\label{eq:integ-cl-fl}
\end{equation}

then:

\begin{equation}
V^*_{cl} - V^*_{cl+fl} = -2.5 \log(I_{cl}/I_{cl+fl})
\end{equation}

using Eq. \ref{eq:integ-cl-fl} we have:

\begin{equation}
V^*_{cl} - V^*_{cl+fl} = -2.5 \log(1 - I_{fl}/I_{cl+fl})
\label{eq:integ-cl-fl2}
\end{equation}

and given:

\begin{equation}
V^*_{fl} - V^*_{cl+fl} = -2.5 \log(I_{fl}/I_{cl+fl}) \Rightarrow \frac{I_{fl}}{I_{cl+fl}} = 10^{(V^*_{fl} - V^*_{cl+fl})/-2.5}
\label{eq:integ-cl-fl3}
\end{equation}

we can combine now Eqs. \ref{eq:integ-cl-fl2} and \ref{eq:integ-cl-fl3} to obtain:

\begin{equation}
V^*_{cl} = -2.5 \log(1 - 10^{(V^*_{fl} - V^*_{cl+fl})/-2.5}) + V^*_{cl+fl}
\end{equation}

\end{document}